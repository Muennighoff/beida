#  第8周

## 1 pandas库

基础数据结构：`Series` `DataFrame` `Panel`分别对应一维、二维、三维数据。

### 1.Series

**基本调用方法：** `s = pd.Series(data, index = INDEX)` 其中index为索引列表，data可以为字典、`ndarray`（需与index长度一致）或标量。

	s = pd.Series([1,2,3,4], index = ['a', 'b', '3'])
	
	s:	a  1
		b  2
		c  3

**基本运算：**和向量运算基本一致，不同之处在于运算时按index对齐而非秩对齐。

### 2.DataFrame

**基本参数：**`DataFrame(data, index, columns)`data为一个存储一维数组、字典、列表或Series的字典，也可以是二维数组、结构或记录数组、另一个DataFrame等；index为行标，columns为列标。

**基本运算：**

`df.index` `df.columns`获取行标列标、列标列表


`df['one']`获取列标为one的一列

`df['three'] = df['one'] + df['two']`整列运算，three列不存在时创建该列。

`df[5]`取第5行

`df[5:10]`按行进行切片

`pd.read_csv('file.csv')`&`pd.to_csv('file.csv')`：操作csv文件

## 2 神经网络

单个神经元可以解决一些简单的问题，但是更复杂的问题需要多个神经元构成多层的神经网络。神经网络变得越发复杂的同时，参数量也在急剧增加，需要一定的方法优化权重参数

### 1.损失函数

衡量输出值与标签值的差异


**常用损失函数：**绝对值求和，平均绝对值求和，平方和误差，均方差，交叉熵

**交叉熵：**![](https://qn-st0.yuketang.cn/FtO4Lr9h04uTMf-DFi6ZVAgFUgnE)是分类任务中常用的损失函数。

常用损失函数可以在tk.keras中直接调用。

### 2.反向传播算法与权重更新

神经网络的运算过程可以看成是函数的嵌套，当所得值与目标值产生差异时可以借助每一步函数的导数来求得梯度，确定调参的最佳方向

**梯度下降法：**找到局部极小值，按照对应梯度反方向，按照步长规定距离，进行迭代搜索。实际运行时会从结果倒推输入，根据函数嵌套一步步求导，即为“反向传播”

**权重更新：**
![](https://qn-st0.yuketang.cn/FvK2d2OOkm6bXuRfpp0_-pMy26bU)

随机初始化->选取样本->计算损失函数->计算偏导数->逐层调整权重

### 3.过拟合

**正则化**有助于防止过拟合，主要有L1正则化（绝对值总和计算惩罚）、L2正则化（权重平方和惩罚）、丢弃正则化等

### 4.实际训练

按照批量进行训练，每一个迷你批次的数据称为一次迭代，训练完所有样本称为一个时代。

训练完成后参数固化，固定每层的权重参数，形成统一的模型参数网络。

### 5.张量

**N维数组**，可以用来表示神经网络

## 3 Logistic Regression

`D:\BDMI\logistic_regression_scratch.ipynb`



